#Testing multi Optioma OU models with OUwie

```{r}
library(phytools)
library(OUwie)
```

##Regime classification:1 {.tabset .tabset-fade}


```{r}
tree<-read.nexus("./data/Final_tree.nex")
dat<-read.csv("./data/Ouwie_data/BPP_OUwie_ManyOptions_optima.csv",row.names = 1)
```


Make simmap tree for selective regime. We classified selective regime based on optima obtained from Barua and Mikheyev 2019. Figure in supplementary shows which snakes were clustered into which regime.
```{r}
ad_reg<-setNames(dat[,2],rownames(dat))
simmap.tre<-make.simmap(tree, ad_reg, model = "ER")
plot(simmap.tre,type="fan",fsize=0.5,ftype="i")
```


###SVSP {.tabset .tabset-fade}
```{r}
dat<-read.csv("./data/Ouwie_data/SVSP_OUwie_ManyOptions_optima.csv")
```

```{r,echo=F}
dat$Reg2<-NULL
dat$Reg3<-NULL
```

####BM
```{r}
BM1_SVSP<-OUwie(phy = simmap.tre,data = dat,model="BM1",simmap.tree=TRUE,diagn = T)
```

```{r}
BM1_SVSP
```

####OU1
```{r}
OU1_SVSP<-OUwie(phy = simmap.tre, data = dat, model="OU1", simmap.tree=T,diagn = T)
```

```{r}
OU1_SVSP
```

```{r}
OU1_SVSP$eigval
OU1_SVSP$solution.se
```

####OUM
```{r}
OUM_SVSP<-OUwie(phy = simmap.tre, data = dat, model="OUM", simmap.tree=T,diagn = T)
```

```{r}
OUM_SVSP
```

####AIC
```{r}
aic<-setNames(c(BM1_SVSP$AICc,OU1_SVSP$AICc,OUM_SVSP$AICc),
              c("BM","OU1","OUM"))
```

```{r}
aic
```

```{r}
aic.w(aic)
```

###TFTx {.tabset .tabset-fade}
```{r}
dat<-read.csv("./data/Ouwie_data/TFTx_OUwie_ManyOptions_optima.csv")
```

```{r,echo=F}
dat$Reg2<-NULL
dat$Reg3<-NULL
```

####BM
```{r}
BM1_TFTx<-OUwie(phy = simmap.tre,data = dat,model="BM1",simmap.tree=TRUE,diagn = T)
```

```{r}
BM1_TFTx
```

####OU1
```{r}
OU1_TFTx<-OUwie(phy = simmap.tre, data = dat, model="OU1", simmap.tree=T,diagn = T)
```

```{r}
OU1_TFTx
```

```{r}
OU1_TFTx$eigval
OU1_TFTx$solution.se
```

####OUM
```{r}
OUM_TFTx<-OUwie(phy = simmap.tre, data = dat, model="OUM", simmap.tree=T,diagn = T)
```

```{r}
OUM_TFTx
```
####AIC
```{r}
aic<-setNames(c(BM1_TFTx$AICc,OU1_TFTx$AICc,OUM_TFTx$AICc),
              c("BM","OU1","OUM"))
```

```{r}
aic
```

```{r}
aic.w(aic)
```

###SVMP {.tabset .tabset-fade}
```{r}
dat<-read.csv("./data/Ouwie_data/SVMP_OUwie_ManyOptions_optima.csv")
```

```{r,echo=F}
dat$Reg2<-NULL
dat$Reg3<-NULL
```

####BM
```{r}
BM1_SVMP<-OUwie(phy = simmap.tre,data = dat,model="BM1",simmap.tree=TRUE,diagn = T)
```

```{r}
BM1_SVMP
```

####OU1
```{r}
OU1_SVMP<-OUwie(phy = simmap.tre, data = dat, model="OU1", simmap.tree=T,diagn = T)
```

```{r}
OU1_SVMP
```

```{r}
OU1_SVMP$eigval
OU1_SVMP$solution.se
```
####OUM
```{r}
OUM_SVMP<-OUwie(phy = simmap.tre, data = dat, model="OUM", simmap.tree=T,diagn = T)
```

```{r}
OUM_SVMP
```

####AIC
```{r}
aic<-setNames(c(BM1_SVMP$AICc,OU1_SVMP$AICc,OUM_SVMP$AICc),
              c("BM","OU1","OUM"))
```

```{r}
aic
```

```{r}
aic.w(aic)
```

###vPLA2 {.tabset .tabset-fade}
```{r}
dat<-read.csv("./data/Ouwie_data/vPLA2_OUwie_ManyOptions_optima.csv")
```

```{r,echo=F}
dat$Reg2<-NULL
dat$Reg3<-NULL
```
####BM
```{r}
BM1_vPLA2<-OUwie(phy = simmap.tre,data = dat,model="BM1",simmap.tree=TRUE,diagn = T)
```

```{r}
BM1_vPLA2
```
####OU1
```{r}
OU1_vPLA2<-OUwie(phy = simmap.tre, data = dat, model="OU1", simmap.tree=T,diagn = T)
```

```{r}
OU1_vPLA2
```

```{r}
OU1_vPLA2$eigval
OU1_vPLA2$solution.se
```
####OUM
```{r}
OUM_vPLA2<-OUwie(phy = simmap.tre, data = dat, model="OUM", simmap.tree=T,diagn = T)
```

```{r}
OUM_vPLA2
```

####AIC
```{r}
aic<-setNames(c(BM1_vPLA2$AICc,OU1_vPLA2$AICc,OUM_vPLA2$AICc),
              c("BM","OU1","OUM"))
```

```{r}
aic
```

```{r}
aic.w(aic)
```

###ePLA2 {.tabset .tabset-fade}
```{r}
dat<-read.csv("./data/Ouwie_data/ePLA2_OUwie_ManyOptions_optima.csv")
```

```{r,echo=F}
dat$Reg2<-NULL
dat$Reg3<-NULL
```
####BM
```{r}
BM1_ePLA2<-OUwie(phy = simmap.tre,data = dat,model="BM1",simmap.tree=TRUE,diagn = T)
```

```{r}
BM1_ePLA2
```
####OU1
```{r}
OU1_ePLA2<-OUwie(phy = simmap.tre, data = dat, model="OU1", simmap.tree=T,diagn = T)
```

```{r}
OU1_ePLA2
```

```{r}
OU1_ePLA2$eigval
OU1_ePLA2$solution.se
```
####OUM
```{r}
OUM_ePLA2<-OUwie(phy = simmap.tre, data = dat, model="OUM", simmap.tree=T,diagn = T)
```

```{r}
OUM_ePLA2
```

####AIC
```{r}
aic<-setNames(c(BM1_ePLA2$AICc,OU1_ePLA2$AICc,OUM_ePLA2$AICc),
              c("BM","OU1","OUM"))
```

```{r}
aic
```

```{r}
aic.w(aic)
```

###CRISP {.tabset .tabset-fade}
```{r}
dat<-read.csv("./data/Ouwie_data/CRISP_OUwie_ManyOptions_optima.csv")
```

```{r,echo=F}
dat$Reg2<-NULL
dat$Reg3<-NULL
```
####BM
```{r}
BM1_CRISP<-OUwie(phy = simmap.tre,data = dat,model="BM1",simmap.tree=TRUE,diagn = T)
```

```{r}
BM1_CRISP
```
####OU1
```{r}
OU1_CRISP<-OUwie(phy = simmap.tre, data = dat, model="OU1", simmap.tree=T,diagn = T)
```

```{r}
OU1_CRISP
```

```{r}
OU1_CRISP$eigval
OU1_CRISP$solution.se
```
####OUM
```{r}
OUM_CRISP<-OUwie(phy = simmap.tre, data = dat, model="OUM", simmap.tree=T,diagn = T)
```

```{r}
OUM_CRISP
```

####AIC
```{r}
aic<-setNames(c(BM1_CRISP$AICc,OU1_CRISP$AICc,OUM_CRISP$AICc),
              c("BM","OU1","OUM"))
```

```{r}
aic
```

```{r}
aic.w(aic)
```

###CTL {.tabset .tabset-fade}
```{r}
dat<-read.csv("./data/Ouwie_data/CTL_OUwie_ManyOptions_optima.csv")
```

```{r,echo=F}
dat$Reg2<-NULL
dat$Reg3<-NULL
```
####BM
```{r}
BM1_CTL<-OUwie(phy = simmap.tre,data = dat,model="BM1",simmap.tree=TRUE,diagn = T)
```

```{r}
BM1_CTL
```
####OU1
```{r}
OU1_CTL<-OUwie(phy = simmap.tre, data = dat, model="OU1", simmap.tree=T,diagn = T)
```

```{r}
OU1_CTL
```

```{r}
OU1_CTL$eigval
OU1_CTL$solution.se
```
####OUM
```{r}
OUM_CTL<-OUwie(phy = simmap.tre, data = dat, model="OUM", simmap.tree=T,diagn = T)
```

```{r}
OUM_CTL
```

####AIC
```{r}
aic<-setNames(c(BM1_CTL$AICc,OU1_CTL$AICc,OUM_CTL$AICc),
              c("BM","OU1","OUM"))
```

```{r}
aic
```

```{r}
aic.w(aic)
```

###GF {.tabset .tabset-fade}
```{r}
dat<-read.csv("./data/Ouwie_data/GF_OUwie_ManyOptions_optima.csv")
```

```{r,echo=F}
dat$Reg2<-NULL
dat$Reg3<-NULL
```
####BM
```{r}
BM1_GF<-OUwie(phy = simmap.tre,data = dat,model="BM1",simmap.tree=TRUE,diagn = T)
```

```{r}
BM1_GF
```
####OU1
```{r}
OU1_GF<-OUwie(phy = simmap.tre, data = dat, model="OU1", simmap.tree=T,diagn = T)
```

```{r}
OU1_GF
```

```{r}
OU1_GF$eigval
OU1_GF$solution.se
```
####OUM
```{r}
OUM_GF<-OUwie(phy = simmap.tre, data = dat, model="OUM", simmap.tree=T,diagn = T)
```

```{r}
OUM_GF
```

####AIC
```{r}
aic<-setNames(c(BM1_GF$AICc,OU1_GF$AICc,OUM_GF$AICc),
              c("BM","OU1","OUM"))
```

```{r}
aic
```

```{r}
aic.w(aic)
```

###BPP {.tabset .tabset-fade}
```{r}
dat<-read.csv("./data/Ouwie_data/BPP_OUwie_ManyOptions_optima.csv")
```

```{r,echo=F}
dat$BPP.CNP_clr<-NULL
dat$Reg2<-NULL
dat$Reg3<-NULL
```
####BM
```{r}
BM1_BPP<-OUwie(phy = simmap.tre,data = dat,model="BM1",simmap.tree=TRUE,diagn = T)
```

```{r}
BM1_BPP
```
####OU1
```{r}
OU1_BPP<-OUwie(phy = simmap.tre, data = dat, model="OU1", simmap.tree=T,diagn = T)
```

```{r}
OU1_BPP
```

```{r}
OU1_BPP$eigval
OU1_BPP$solution.se
```
####OUM
```{r}
OUM_BPP<-OUwie(phy = simmap.tre, data = dat, model="OUM", simmap.tree=T,diagn = T)
```

```{r}
OUM_BPP
```

####AIC
```{r}
aic<-setNames(c(BM1_BPP$AICc,OU1_BPP$AICc,OUM_BPP$AICc),
              c("BM","OU1","OUM"))
```

```{r}
aic
```

```{r}
aic.w(aic)
```

###LAAO {.tabset .tabset-fade}
```{r}
dat<-read.csv("./data/Ouwie_data/LAAO_OUwie_ManyOptions_optima.csv")
```

```{r,echo=F}
dat$Reg2<-NULL
dat$Reg3<-NULL
```
####BM
```{r}
BM1_LAAO<-OUwie(phy = simmap.tre,data = dat,model="BM1",simmap.tree=TRUE,diagn = T)
```

```{r}
BM1_LAAO
```
####OU1
```{r}
OU1_LAAO<-OUwie(phy = simmap.tre, data = dat, model="OU1", simmap.tree=T,diagn = T)
```

```{r}
OU1_LAAO
```

```{r}
OU1_LAAO$eigval
OU1_LAAO$solution.se
```
####OUM
```{r}
OUM_LAAO<-OUwie(phy = simmap.tre, data = dat, model="OUM", simmap.tree=T,diagn = T)
```

```{r}
OUM_LAAO
```

####AIC
```{r}
aic<-setNames(c(BM1_LAAO$AICc,OU1_LAAO$AICc,OUM_LAAO$AICc),
              c("BM","OU1","OUM"))
```

```{r}
aic
```

```{r}
aic.w(aic)
```

###KSPI {.tabset .tabset-fade}
```{r}
dat<-read.csv("./data/Ouwie_data/KSPI_OUwie_ManyOptions_optima.csv")
```

```{r,echo=F}
dat$Reg2<-NULL
dat$Reg3<-NULL
```
####BM
```{r}
BM1_KSPI<-OUwie(phy = simmap.tre,data = dat,model="BM1",simmap.tree=TRUE,diagn = T)
```

```{r}
BM1_KSPI
```
####OU1
```{r}
OU1_KSPI<-OUwie(phy = simmap.tre, data = dat, model="OU1", simmap.tree=T,diagn = T)
```

```{r}
OU1_KSPI
```

```{r}
OU1_KSPI$eigval
OU1_KSPI$solution.se
```
####OUM
```{r}
OUM_KSPI<-OUwie(phy = simmap.tre, data = dat, model="OUM", simmap.tree=T,diagn = T)
```

```{r}
OUM_KSPI
```

####AIC
```{r}
aic<-setNames(c(BM1_KSPI$AICc,OU1_KSPI$AICc,OUM_KSPI$AICc),
              c("BM","OU1","OUM"))
```

```{r}
aic
```

```{r}
aic.w(aic)
```

###GF {.tabset .tabset-fade}
```{r}
dat<-read.csv("./data/Ouwie_data/GF_OUwie_ManyOptions_optima.csv")
```

```{r,echo=F}
dat$Reg2<-NULL
dat$Reg3<-NULL
```
####BM
```{r}
BM1_GF<-OUwie(phy = simmap.tre,data = dat,model="BM1",simmap.tree=TRUE,diagn = T)
```

```{r}
BM1_GF
```
####OU1
```{r}
OU1_GF<-OUwie(phy = simmap.tre, data = dat, model="OU1", simmap.tree=T,diagn = T)
```

```{r}
OU1_GF
```

```{r}
OU1_GF$eigval
OU1_GF$solution.se
```
####OUM
```{r}
OUM_GF<-OUwie(phy = simmap.tre, data = dat, model="OUM", simmap.tree=T,diagn = T)
```

```{r}
OUM_GF
```

####AIC
```{r}
aic<-setNames(c(BM1_GF$AICc,OU1_GF$AICc,OUM_GF$AICc),
              c("BM","OU1","OUM"))
```

```{r}
aic
```

```{r}
aic.w(aic)
```

```{r}
devtools::session_info()
```